'use strict';var _regenerator=require('babel-runtime/regenerator'),_regenerator2=_interopRequireDefault(_regenerator),_asyncToGenerator2=require('babel-runtime/helpers/asyncToGenerator'),_asyncToGenerator3=_interopRequireDefault(_asyncToGenerator2),_promise=require('babel-runtime/core-js/promise'),_promise2=_interopRequireDefault(_promise),_localforage=require('localforage'),_localforage2=_interopRequireDefault(_localforage);Object.defineProperty(exports,'__esModule',{value:!0});function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}var expiryTime=function(a){return a?new Date().getTime()+1e3*(60*a):a};Cache={get:function get(a){var b=1<arguments.length&&arguments[1]!==void 0&&arguments[1];return new _promise2.default(function(c,d){_localforage2.default.getItem(a).then(function(e){var f=b;e&&(e.minutes>new Date().getTime()||0==e.minutes)&&(f=e.data),c(f)}).catch(function(e){d(e)})})},pull:function pull(a){var b=Cache.get(a);return Cache.remove(a),b},set:function(){var a=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function b(c,d){var e=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0;return _regenerator2.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if('function'!=typeof d){g.next=4;break}return g.next=3,d();case 3:d=g.sent;case 4:return g.abrupt('return',new _promise2.default(function(h,i){_localforage2.default.setItem(c,{data:d,minutes:expiryTime(e)}).then(function(j){h(j.data)}).catch(function(j){i(j)})}));case 5:case'end':return g.stop();}},b,void 0)}));return function set(){return a.apply(this,arguments)}}(),put:function put(a,b){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0;return Cache.set(a,b,c)},add:function add(a,b){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0;return Cache.set(a,b,c)},forever:function forever(a,b){return Cache.set(a,b,0)},has:function has(a){return new _promise2.default(function(b,c){Cache.get(a).then(function(d){b(!!d)}).catch(function(d){c(d)})})},remember:function(){var a=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function b(c,d){var e=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0;return _regenerator2.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,Cache.has(c);case 2:if(!g.sent){g.next=6;break}return g.abrupt('return',Cache.get(c));case 6:return g.abrupt('return',Cache.set(c,d,e));case 7:case'end':return g.stop();}},b,void 0)}));return function remember(){return a.apply(this,arguments)}}(),remove:function remove(a){return new _promise2.default(function(b,c){_localforage2.default.removeItem(a).then(function(){b()}).catch(function(d){c(d)})})},deleter:function deleter(a){return Cache.remove(a)},forget:function forget(a){return Cache.remove(a)},flush:function(){var a=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function b(){var c;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Cache.keys();case 2:c=e.sent,c.forEach(function(f){return Cache.remove(f)});case 4:case'end':return e.stop();}},b,void 0)}));return function flush(){return a.apply(this,arguments)}}(),keys:function keys(){return new _promise2.default(function(a,b){_localforage2.default.keys().then(function(c){a(c)}).catch(function(c){b(c)})})},key:function key(){return new _promise2.default(function(a,b){_localforage2.default.key(keyIndex).then(function(c){a(c)}).catch(function(c){b(c)})})}},exports.default=Cache;
